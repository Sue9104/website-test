webpackJsonp([9],{"9DmR":function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{attrs:{id:"projectDetailMain"}},[r("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[r("el-breadcrumb-item",{attrs:{to:{path:"/projectlist"}}},[t._v("Project List")]),t._v(" "),r("el-breadcrumb-item",[t._v("Detail")])],1),t._v(" "),r("div",{attrs:{id:"projectDetailCon"}},[r("el-tabs",{on:{"tab-click":t.handleClick},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[r("el-tab-pane",{attrs:{label:"Information",name:"info"}},[r("el-card",{staticClass:"box-card",attrs:{shadow:"always"}},[r("div",{attrs:{slot:"header"},slot:"header"},[r("span",{staticClass:"cardTitle"},[t._v("Information")]),t._v(" "),r("el-button",{staticClass:"operationBtn",attrs:{size:"large",type:"text"},on:{click:t.openEditProject}},[t._v("Edit")]),t._v(" "),r("el-button",{staticClass:"operationBtn",staticStyle:{color:"orange"},attrs:{size:"large",type:"text"},on:{click:t.deleteProject}},[t._v("Delete")])],1),t._v(" "),r("div",[r("div",{staticClass:"infoItem"},[t._v("Project: "),r("span",[t._v(t._s(t.currentProject.product))])]),t._v(" "),r("div",{staticClass:"infoItem"},[t._v("Attribute: "),r("span",[t._v(t._s(t.currentProject.attribute))])]),t._v(" "),r("div",{staticClass:"infoItem"},[t._v("Priority: \n              "),"1"==t.currentProject.priority?r("span",[t._v("Low")]):t._e(),t._v(" "),"2"==t.currentProject.priority?r("span",[t._v("Normal")]):t._e(),t._v(" "),"3"==t.currentProject.priority?r("span",{staticStyle:{color:"red"}},[t._v("High")]):t._e()]),t._v(" "),r("div",{staticClass:"infoItem"},[t._v("Language: "),r("span",[t._v(t._s(t.currentProject.lang))])]),t._v(" "),r("div",{staticClass:"infoItem"},[t._v("Creator: "),r("span",[t._v(t._s(t.currentProject.users_name))])]),t._v(" "),r("div",{staticClass:"infoItem"},[t._v("Deadline: "),r("span",[t._v(t._s(t.currentProject.deadline&&t.currentProject.deadline.split(" ")[1]?t.currentProject.deadline.split(" ")[0]:t.currentProject.deadline))])]),t._v(" "),r("div",{staticClass:"infoItem"},[t._v("CreateDate: "),r("span",[t._v(t._s(t.currentProject.created_at&&t.currentProject.created_at.split(" ")[1]?t.currentProject.created_at.split(" ")[0]:t.currentProject.created_at))])]),t._v(" "),r("div",{staticClass:"infoItem"},[t._v("Description: "),r("span",[t._v(t._s(t.currentProject.product_desc))])])])]),t._v(" "),r("el-card",{staticClass:"box-card",attrs:{shadow:"always"}},[r("div",{attrs:{slot:"header"},slot:"header"},[r("span",{staticClass:"cardTitle"},[t._v("Add Members")]),t._v(" "),t.membersFlag?t._e():r("el-button",{staticClass:"operationBtn",attrs:{size:"large",type:"text"},on:{click:function(e){t.membersFlag=!0}}},[t._v("Edit")]),t._v(" "),t.membersFlag?r("el-button",{staticClass:"operationBtn submitBtn",attrs:{size:"large",type:"text"},on:{click:t.allSubmitMembers}},[t._v("All Submit")]):t._e(),t._v(" "),t.membersFlag?r("el-button",{staticClass:"operationBtn cancelBtn",attrs:{size:"large",type:"text"},on:{click:function(e){t.membersFlag=!1}}},[t._v("Cancel")]):t._e()],1),t._v(" "),r("el-form",{ref:"addMembersForm",attrs:{model:t.addMembersForm,"label-position":"left","label-width":"100px"}},[r("el-form-item",{attrs:{prop:"translate_users",label:"Translator"}},[r("div",{staticClass:"membersInput"},[r("div",t._l(t.currentProject.translatorName,function(e,a){return r("span",{key:a,staticStyle:{"margin-right":"6px"}},[t._v(t._s(e))])})),t._v(" "),r("el-select",{attrs:{disabled:!t.membersFlag,placeholder:"please select translator",multiple:""},on:{change:function(e){t.changeUser("t",e)}},model:{value:t.addMembersForm.translate_users,callback:function(e){t.$set(t.addMembersForm,"translate_users",e)},expression:"addMembersForm.translate_users"}},t._l(t.currentProject.remainingUserList,function(e,a){return"t"===e.status||""===e.status?r("el-option",{key:"Translator"+a,attrs:{label:e.name,value:e.id}}):t._e()})),t._v(" "),t.membersFlag?r("el-button",{attrs:{size:"medium",type:"warning"},on:{click:function(e){t.submitMembers("translator")}}},[t._v("Submit")]):t._e()],1)]),t._v(" "),r("el-form-item",{attrs:{prop:"approve_users",label:"Approver"}},[r("div",{staticClass:"membersInput"},[r("div",t._l(t.currentProject.approverName,function(e,a){return r("span",{key:a,staticStyle:{margin:"6px"}},[t._v(t._s(e))])})),t._v(" "),r("el-select",{attrs:{disabled:!t.membersFlag,placeholder:"please select approver",multiple:""},on:{change:function(e){t.changeUser("a",e)}},model:{value:t.addMembersForm.approve_users,callback:function(e){t.$set(t.addMembersForm,"approve_users",e)},expression:"addMembersForm.approve_users"}},t._l(t.currentProject.remainingUserList,function(e,a){return"a"===e.status||""===e.status?r("el-option",{key:"approver"+a,attrs:{label:e.name,value:e.id}}):t._e()})),t._v(" "),t.membersFlag?r("el-button",{attrs:{size:"medium",type:"warning"},on:{click:function(e){t.submitMembers("reviewer")}}},[t._v("Submit")]):t._e()],1)]),t._v(" "),r("el-form-item",{attrs:{prop:"viewed_users",label:"Viewer"}},[r("div",{staticClass:"membersInput"},[r("div",t._l(t.currentProject.viewerName,function(e,a){return r("span",{key:a,staticStyle:{margin:"6px"}},[t._v(t._s(e))])})),t._v(" "),r("el-select",{attrs:{disabled:"private"===t.currentProject.attribute||!t.membersFlag,placeholder:"please select viewer",multiple:""},on:{change:function(e){t.changeUser("v",e)}},model:{value:t.addMembersForm.viewed_users,callback:function(e){t.$set(t.addMembersForm,"viewed_users",e)},expression:"addMembersForm.viewed_users"}},t._l(t.currentProject.remainingUserList,function(e,a){return"v"===e.status||""===e.status?r("el-option",{key:"Viewer"+a,attrs:{label:e.name,value:e.id}}):t._e()})),t._v(" "),"public"===t.currentProject.attribute&&t.membersFlag?r("el-button",{attrs:{size:"medium",type:"warning"},on:{click:function(e){t.submitMembers("viewer")}}},[t._v("Submit")]):t._e()],1)])],1)],1)],1),t._v(" "),r("el-tab-pane",{attrs:{label:"Schedule",name:"schedule"}},[r("el-card",{staticClass:"box-card",attrs:{shadow:"always"}},[r("div",{attrs:{slot:"header"},slot:"header"},[r("span",{staticClass:"cardTitle"},[t._v("Project Schedule")]),t._v(" "),r("el-button",{staticClass:"operationBtn",attrs:{size:"large",type:"text"},on:{click:t.viewAllocationList}},[t._v("Entry List")]),t._v(" "),r("el-button",{staticClass:"operationBtn",attrs:{size:"large",type:"text"},on:{click:t.viewObjectionList}},[t._v("Objection List")])],1),t._v(" "),r("div",{staticClass:"statisticsCon"},[r("span",{staticStyle:{"margin-right":"10px"}},[t._v("Total number of entries: "+t._s(t.statisticInfo.total_nums))]),t._v(" "),r("div",{staticClass:"progressItem"},[r("span",[t._v("Allocation:")]),t._v(" "),r("el-progress",{attrs:{"stroke-width":4,percentage:t.statisticInfo.allocationPercentage}})],1),t._v(" "),r("div",{staticClass:"progressItem"},[r("span",[t._v("Translation:")]),t._v(" "),r("el-progress",{attrs:{"stroke-width":4,percentage:t.statisticInfo.translationPercentage}})],1),t._v(" "),r("div",{staticClass:"progressItem"},[r("span",[t._v("Approval:")]),t._v(" "),r("el-progress",{attrs:{"stroke-width":4,percentage:t.statisticInfo.approvalPercentage}})],1)])]),t._v(" "),r("el-card",{staticClass:"box-card",attrs:{shadow:"always"}},[r("div",{attrs:{slot:"header"},slot:"header"},[r("span",{staticClass:"cardTitle"},[t._v("Members Schedule")])]),t._v(" "),r("div",{staticClass:"statisticsCon"},[r("div",{staticClass:"progressItem"},[r("span",[t._v("Allocator:\n                "),r("div",{staticStyle:{margin:"6px 20px"}},[t._v("\n                  "+t._s(t.currentProject.users_name)+"\n                  "),r("el-progress",{attrs:{"stroke-width":4,percentage:t.statisticInfo.allocationPercentage}})],1)])]),t._v(" "),r("div",{staticClass:"progressItem"},[r("span",[t._v("Translators:\n                "),t._l(t.currentProject.translatorName,function(e,a){return r("div",{key:a,staticStyle:{margin:"6px 20px"}},[t._v(t._s(e)+"\n                  "),t.translatorsStatistics[e]?r("el-progress",{attrs:{"stroke-width":4,percentage:t.translatorsStatistics[e]&&t.translatorsStatistics[e].Error+t.translatorsStatistics[e].Qualified+t.translatorsStatistics[e]["Re-translated"]+t.translatorsStatistics[e].Unreviewed+t.translatorsStatistics[e].Untranslated?100*(t.translatorsStatistics[e].Error+t.translatorsStatistics[e].Qualified+t.translatorsStatistics[e].Unreviewed)/(t.translatorsStatistics[e].Error+t.translatorsStatistics[e].Qualified+t.translatorsStatistics[e]["Re-translated"]+t.translatorsStatistics[e].Unreviewed+t.translatorsStatistics[e].Untranslated):0}}):t._e(),t._v(" "),t.translatorsStatistics[e]?t._e():r("span",{staticStyle:{color:"#aaa","font-size":"14px"}},[t._v("[ Unassigned task ]")])],1)})],2)]),t._v(" "),r("div",{staticClass:"progressItem"},[r("span",[t._v("Approvers:\n                "),t._l(t.currentProject.approverName,function(e,a){return r("div",{key:a,staticStyle:{margin:"6px 20px"}},[t._v(t._s(e)+"\n                  "),t.approversStatistics[e]?r("el-progress",{attrs:{"stroke-width":4,percentage:t.approversStatistics[e]&&t.approversStatistics[e].Error+t.approversStatistics[e].Qualified+t.approversStatistics[e]["Re-translated"]+t.approversStatistics[e].Unreviewed?100*(t.approversStatistics[e].Error+t.approversStatistics[e].Qualified+t.approversStatistics[e]["Re-translated"])/(t.approversStatistics[e].Error+t.approversStatistics[e].Qualified+t.approversStatistics[e]["Re-translated"]+t.approversStatistics[e].Unreviewed):0}}):t._e()],1)})],2)])])])],1),t._v(" "),r("el-tab-pane",{attrs:{label:"Upload",name:"upload"}},[r("el-card",{staticClass:"box-card",attrs:{shadow:"always"}},[r("div",{attrs:{slot:"header"},slot:"header"},[r("span",{staticClass:"cardTitle"},[t._v("Upload")])]),t._v(" "),r("div",[r("el-button",{attrs:{type:"primary",size:"large"},on:{click:t.downloadFileFormat}},[t._v("Export Format")]),t._v(" "),r("el-button",{attrs:{type:"primary",size:"large"},on:{click:t.openUploadModal}},[t._v("Upload File")])],1),t._v(" "),r("div",{staticClass:"recordListCon"},[t._v("Import records:\n            "),0===t.importList.length?r("span",{staticStyle:{color:"#ccc"}},[t._v("[ No Record ]")]):t._e(),t._v(" "),t._l(t.importList,function(e,a){return t.importList.lenght>0?r("div",{key:a,staticClass:"versionHistoryItem",attrs:{title:"export this version"}},[r("span",[t._v(t._s(e))]),t._v(" "),r("span",{staticStyle:{"margin-left":"30px"}},[t._v("时间")])]):t._e()})],2)])],1),t._v(" "),r("el-tab-pane",{attrs:{label:"Export",name:"export"}},[r("el-card",{staticClass:"box-card",attrs:{shadow:"always"}},[r("div",{attrs:{slot:"header"},slot:"header"},[r("span",{staticClass:"cardTitle"},[t._v("Version Export & History")])]),t._v(" "),r("div",[r("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.openExportVersionModal}},[t._v("Export New Version")])],1),t._v(" "),r("div",{staticClass:"recordListCon"},[t._v("Export records:\n            "),t.versionList[0].version_name?t._e():r("span",{staticStyle:{color:"#ccc"}},[t._v("[ No Record ]")]),t._v(" "),t._l(t.versionList,function(e,a){return t.versionList[0].version_name?r("div",{key:a,staticClass:"versionHistoryItem",attrs:{title:"export the version"},on:{click:function(r){t.exportHistoryVersion(e.version_name)}}},[r("span",[t._v(t._s(e.version_name))]),t._v(" "),r("span",{staticStyle:{"margin-left":"30px"}},[t._v("时间")]),t._v(" "),r("span",{staticStyle:{"margin-left":"30px"}},[r("el-button",{attrs:{size:"small",type:"text"},on:{click:t.openExportVersionModal}},[t._v("download")])],1)]):t._e()})],2)])],1)],1),t._v(" "),r("el-dialog",{attrs:{title:"Operation",visible:t.dialogVisible,width:"30%"},on:{"update:visible":function(e){t.dialogVisible=e}}},[r("span",[t._v("Version ID: ")]),t._v(" "),r("el-input-number",{attrs:{size:"small",step:.1,precision:1,min:t.currentProject.version_name?(10*Number(this.currentProject.version_name.substr(1))+1)/10:.1,max:t.currentProject.version_name?Math.floor(Number(this.currentProject.version_name.substr(1))+1):1},model:{value:t.newVersionID,callback:function(e){t.newVersionID=e},expression:"newVersionID"}}),t._v(" "),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("Cancel")]),t._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:t.exportQualified}},[t._v("Export")])],1)],1),t._v(" "),r("el-dialog",{attrs:{title:"Upload File",visible:t.dialogUploadVisible,"close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(e){t.dialogUploadVisible=e},close:t.closeUploadModal}},[r("input",{staticStyle:{display:"none"},attrs:{type:"file",id:"translateUpload",accept:".csv"},on:{change:t.changeImportFile}}),t._v(" "),r("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.procductImport}},[t._v("Select File")]),t._v(" "),r("div",{staticStyle:{"font-size":"14px",margin:"8px 0"}},[t._v("File Name：\n        "),r("span",{staticStyle:{"font-weight":"bold"}},[t._v(t._s(t.uploadFile.name?t.uploadFile.name:""))]),t._v(" "),r("i",{directives:[{name:"show",rawName:"v-show",value:t.uploadLoadingFlag,expression:"uploadLoadingFlag"}],staticClass:"el-icon-loading"})]),t._v(" "),r("el-dialog",{attrs:{width:"50%",title:"Upload Result",visible:t.resultVisible,"append-to-body":"","close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(e){t.resultVisible=e},close:t.closeResultModal}},[r("div",t._l(t.uploadResult,function(e,a,s){return r("div",{staticStyle:{"border-bottom":"1px dashed #ccc","margin-bottom":"20px"}},t._l(e,function(e,a,s){return r("div",[r("span",[t._v(t._s(a)+":")]),t._v(" "),r("span",{staticStyle:{"font-weight":"bold","margin-left":"5px"}},[t._v(t._s(e))])])}))}))])],1),t._v(" "),r("el-dialog",{attrs:{title:"Edit",visible:t.editDialogVisible,width:"40%"},on:{"update:visible":function(e){t.editDialogVisible=e}}},[r("el-form",{ref:"editProjectForm",staticClass:"demo-ruleForm",attrs:{model:t.editProjectForm,rules:t.rules,"label-width":"90px"}},[r("el-form-item",{attrs:{prop:"product",label:"Project:"}},[r("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"please enter project name"},model:{value:t.editProjectForm.product,callback:function(e){t.$set(t.editProjectForm,"product","string"==typeof e?e.trim():e)},expression:"editProjectForm.product"}})],1),t._v(" "),r("el-form-item",{attrs:{prop:"attribute",label:"Attribute:"}},[r("el-radio-group",{model:{value:t.editProjectForm.attribute,callback:function(e){t.$set(t.editProjectForm,"attribute",e)},expression:"editProjectForm.attribute"}},[r("el-radio",{attrs:{label:"public"}},[t._v("Public")]),t._v(" "),r("el-radio",{attrs:{label:"private",disabled:""}},[t._v("Private")])],1)],1),t._v(" "),r("el-form-item",{attrs:{prop:"priority",label:"Priority:"}},[r("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"please select priority"},model:{value:t.editProjectForm.priority,callback:function(e){t.$set(t.editProjectForm,"priority",e)},expression:"editProjectForm.priority"}},[r("el-option",{attrs:{label:"High",value:3}}),t._v(" "),r("el-option",{attrs:{label:"Normal",value:2}}),t._v(" "),r("el-option",{attrs:{label:"Low",value:1}})],1)],1),t._v(" "),r("el-form-item",{attrs:{prop:"lang",label:"Language:"}},[r("el-select",{staticStyle:{width:"49%"},attrs:{placeholder:"source language"},model:{value:t.editProjectForm.slang,callback:function(e){t.$set(t.editProjectForm,"slang",e)},expression:"editProjectForm.slang"}},[r("el-option",{attrs:{label:"ZH-CN",value:"ZH-CN"}}),t._v(" "),r("el-option",{attrs:{label:"EN",value:"EN"}})],1),t._v(" "),r("el-select",{staticStyle:{width:"49%"},attrs:{placeholder:"target language"},model:{value:t.editProjectForm.tlang,callback:function(e){t.$set(t.editProjectForm,"tlang",e)},expression:"editProjectForm.tlang"}},[r("el-option",{attrs:{label:"ZH-CN",value:"ZH-CN"}}),t._v(" "),r("el-option",{attrs:{label:"EN",value:"EN"}})],1)],1),t._v(" "),r("el-form-item",{attrs:{prop:"deadline",label:"Deadline:"}},[r("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date","default-value":new Date,"value-format":"yyyy-MM-dd","picker-options":t.pickerOptions,placeholder:"please select deadline"},model:{value:t.editProjectForm.deadline,callback:function(e){t.$set(t.editProjectForm,"deadline","string"==typeof e?e.trim():e)},expression:"editProjectForm.deadline"}})],1),t._v(" "),r("el-form-item",{attrs:{prop:"product_desc",label:"Description:"}},[r("el-input",{staticStyle:{width:"100%"},attrs:{type:"textarea",placeholder:"please enter description of product"},model:{value:t.editProjectForm.product_desc,callback:function(e){t.$set(t.editProjectForm,"product_desc","string"==typeof e?e.trim():e)},expression:"editProjectForm.product_desc"}})],1)],1),t._v(" "),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(e){t.editDialogVisible=!1}}},[t._v("Cancel")]),t._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:function(e){t.submitProject("editProjectForm")}}},[t._v("Submit")])],1)],1)],1)],1)},staticRenderFns:[]}},Igh9:function(t,e,r){var a=r("VU/8")(r("sbv9"),r("9DmR"),!1,function(t){r("mkn+")},"data-v-2dfa5770",null);t.exports=a.exports},NVzM:function(t,e,r){(t.exports=r("FZ+f")(!1)).push([t.i,"",""])},"mkn+":function(t,e,r){var a=r("NVzM");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);r("rjj0")("56d8b979",a,!0,{})},sbv9:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={mounted:function(){var t=this;switch(this.$route.query.pane){case"info":this.activeName="info";break;case"schedule":this.activeName="schedule";break;case"upload":this.activeName="upload";break;case"export":this.activeName="export"}new Promise(function(e,r){t.$http.post("/api/user/list").then(function(r){t.userList=r.data.data,e("success")}).catch(function(t){r("Request failed!")})}).then(function(e){t.projectDetail()},function(t){console.log(t)}),this.$http.post("/api/Statistic/ProductAccount",qs.stringify({product_id:this.$route.query.id})).then(function(e){e.data.result.allocationPercentage=e.data.result.total_nums?parseInt((e.data.result.total_nums-e.data.result.Unassigned)/e.data.result.total_nums*1e3)/10:0,e.data.result.translationPercentage=e.data.result.total_nums-e.data.result.Unassigned>0?parseInt((e.data.result.total_nums-e.data.result.Unassigned-e.data.result.Untranslated-e.data.result["Re-translated"])/(e.data.result.total_nums-e.data.result.Unassigned)*1e3)/10:0,e.data.result.approvalPercentage=e.data.result.Qualified+e.data.result.Unreviewed?parseInt(e.data.result.Qualified/(e.data.result.Qualified+e.data.result.Unreviewed)*1e3)/10:0,t.statisticInfo=e.data.result}),this.$http.post("/api/Statistic/Accout_task_p",qs.stringify({product_id:this.$route.query.id})).then(function(e){for(var r in t.translatorsStatistics=e.data.result.static_t,e.data.result.static_a)"Unreviewed"!==r&&(t.approversStatistics[r]=e.data.result.static_a[r],t.approversStatistics[r].Unreviewed=e.data.result.static_a.Unreviewed)})},data:function(){var t=this;return{pickerOptions:{disabledDate:function(t){return t&&t.valueOf()<=Date.now()}},editDialogVisible:!1,editProjectForm:{product:"",attribute:"",priority:"",deadline:"",lang:"",slang:"",tlang:"",product_desc:""},activeName:"info",statisticsFlag:!1,translatorsStatistics:{},approversStatistics:{},importList:[],versionList:[{version_name:""}],currentProject:{},userList:[],statisticInfo:{allocationPercentage:0,translationPercentage:0,approvalPercentage:0},membersFlag:!1,addMembersForm:{translate_users:[],approve_users:[],viewed_users:[]},dialogVisible:!1,newVersionID:1,dialogUploadVisible:!1,resultVisible:!1,uploadLoadingFlag:!1,uploadResult:{success_nums:[],error_row:[],row_key:[]},uploadProjectId:null,uploadFile:{},rules:{product:[{required:!0,message:"Please enter product."}],attribute:[{required:!0,message:"Please enter attribute."}],priority:[{required:!0,message:"Please enter priority."}],lang:[{required:!0,message:"Please select language."},{validator:function(e,r,a){""===t.editProjectForm.slang?a(new Error("Please select source language.")):""===t.editProjectForm.tlang?a(new Error("Please select target language.")):t.editProjectForm.slang===t.editProjectForm.tlang?a(new Error("The source language cannot be the same as the target language.")):a()},trigger:"blur"}],deadline:[{required:!0,message:"Please select deadline."}]}}},watch:{"editProjectForm.slang":{handler:function(t,e){this.editProjectForm.lang=this.editProjectForm.slang+"->"+this.editProjectForm.tlang},deep:!0},"editProjectForm.tlang":{handler:function(t,e){this.editProjectForm.lang=this.editProjectForm.slang+"->"+this.editProjectForm.tlang},deep:!0},translatorsStatistics:{handler:function(t){},deep:!0},approversStatistics:{handler:function(t){},deep:!0},"addMembersForm.translate_users":{handler:function(t,e){if(t.length>e.length)this.currentProject.remainingUserList.forEach(function(e){t[length-1]===e.id&&(e.status="t")});else{var r=void 0;e.forEach(function(e,a){t.indexOf(e)<0&&(r=e)}),this.currentProject.remainingUserList.forEach(function(t){r===t.id&&(t.status="")})}},deep:!0},"addMembersForm.approve_users":{handler:function(t,e){if(t.length>e.length)this.currentProject.remainingUserList.forEach(function(e){t[length-1]===e.id&&(e.status="a")});else{var r=void 0;e.forEach(function(e,a){t.indexOf(e)<0&&(r=e)}),this.currentProject.remainingUserList.forEach(function(t){r===t.id&&(t.status="")})}},deep:!0},"addMembersForm.viewed_users":{handler:function(t,e){if(t.length>e.length)this.currentProject.remainingUserList.forEach(function(e){t[length-1]===e.id&&(e.status="v")});else{var r=void 0;e.forEach(function(e,a){t.indexOf(e)<0&&(r=e)}),this.currentProject.remainingUserList.forEach(function(t){r===t.id&&(t.status="")})}},deep:!0}},methods:{projectDetail:function(){var t=this;this.$http.post("/api/product/details",qs.stringify({product_id:this.$route.query.id})).then(function(e){e.data.data.forEach(function(e){t.$set(e,"translatorName",[]),t.$set(e,"approverName",[]),t.$set(e,"viewerName",[]),t.$set(e,"remainingUserList",[]),JSON.parse(e.translate_users).forEach(function(r){t.userList.forEach(function(t){r===t.id&&e.translatorName.push(t.name)})}),JSON.parse(e.approve_users).forEach(function(r){t.userList.forEach(function(t){r===t.id&&e.approverName.push(t.name)})}),JSON.parse(e.viewed_users).forEach(function(r){t.userList.forEach(function(t){r===t.id&&e.viewerName.push(t.name)})}),t.userList.forEach(function(t){var r=!1;JSON.parse(e.translate_users).forEach(function(e){t.id===e&&(r=!0)}),JSON.parse(e.approve_users).forEach(function(e){t.id===e&&(r=!0)}),JSON.parse(e.viewed_users).forEach(function(e){t.id===e&&(r=!0)}),r||(t.status="",e.remainingUserList.push(t))})}),t.versionList=e.data.data,t.currentProject=e.data.data[0]})},handleClick:function(t,e){this.$router.push({path:"/projectdetail",query:{id:this.$route.query.id,pane:t.name}})},deleteProject:function(){var t=this;this.$confirm("Confirm to delete the project?","Confirm",{confirmButtonText:"Delete",cancelButtonText:"Cancel",type:"warning",center:!0}).then(function(){t.$http.post("/api/product/delete_p",qs.stringify({id:t.$route.query.id})).then(function(t){t.data.success})}).catch(function(){})},openEditProject:function(){this.editDialogVisible=!0,this.editProjectForm.product=this.currentProject.product,this.editProjectForm.attribute=this.currentProject.attribute,this.editProjectForm.priority=this.currentProject.priority,this.editProjectForm.deadline=this.currentProject.deadline,this.editProjectForm.product_desc=this.currentProject.product_desc,this.editProjectForm.slang=this.currentProject.lang.split("->")[0],this.editProjectForm.tlang=this.currentProject.lang.split("->")[1]},submitProject:function(t){var e=this;this.$refs[t].validate(function(t){if(t){var r={id:e.$route.query.id,product:e.editProjectForm.product,attribute:e.editProjectForm.attribute,priority:e.editProjectForm.priority,deadline:e.editProjectForm.deadline,product_desc:e.editProjectForm.product_desc,lang:e.editProjectForm.slang+"->"+e.editProjectForm.tlang};e.$http.post("/api/product/edit_product",qs.stringify(r)).then(function(t){t.data.success&&(e.editDialogVisible=!1,e.projectDetail())})}})},allSubmitMembers:function(){var t=this,e=[],r={};r.id=this.$route.query.id,0!==this.addMembersForm.translate_users.length&&(r.users=JSON.stringify(this.addMembersForm.translate_users),r.role="translator",e.push(r));var a={};a.id=this.$route.query.id,0!==this.addMembersForm.approve_users.length&&(a.users=JSON.stringify(this.addMembersForm.approve_users),a.role="reviewer",e.push(a));var s={};s.id=this.$route.query.id,0!==this.addMembersForm.viewed_users.length&&(s.users=JSON.stringify(this.addMembersForm.viewed_users),s.role="viewer",e.push(s)),0===e.length?this.membersFlag=!1:e.forEach(function(e){t.$http.post("/api/product/add_t_ap",qs.stringify({id:t.$route.query.id,users:e.users,role:e.role})).then(function(e){e.data.success&&(t.membersFlag=!1,t.addMembersForm.translate_users=[],t.addMembersForm.approve_users=[],t.addMembersForm.viewed_users=[],t.projectDetail())})})},submitMembers:function(t){var e=this,r={};switch(r.id=this.$route.query.id,t){case"translator":0!==this.addMembersForm.translate_users.length&&(r.users=JSON.stringify(this.addMembersForm.translate_users),r.role=t);break;case"reviewer":0!==this.addMembersForm.approve_users.length&&(r.users=JSON.stringify(this.addMembersForm.approve_users),r.role=t);break;case"viewer":0!==this.addMembersForm.viewed_users.length&&(r.users=JSON.stringify(this.addMembersForm.viewed_users),r.role=t)}0!==JSON.parse(r.users).length?this.$http.post("/api/product/add_t_ap",qs.stringify(r)).then(function(r){if(r.data.success)switch(e.membersFlag=!1,t){case"translator":e.addMembersForm.translate_users=[],e.projectDetail();break;case"reviewer":e.addMembersForm.approve_users=[],e.projectDetail();break;case"viewer":e.addMembersForm.viewed_users=[],e.projectDetail()}}):(this.membersFlag=!1,this.$message({message:"No one is selected!",type:"warning"}))},changeUser:function(t,e){var r=this;switch(t){case"t":e.forEach(function(t){r.currentProject.remainingUserList.forEach(function(e){t===e.id&&(e.status="t")})});break;case"a":e.forEach(function(t){r.currentProject.remainingUserList.forEach(function(e){t===e.id&&(e.status="a")})});break;case"v":e.forEach(function(t){r.currentProject.remainingUserList.forEach(function(e){t===e.id&&(e.status="v")})})}},openExportVersionModal:function(){this.currentProject.version_name?this.newVersionID=Number(this.currentProject.version_name.substr(1))+.1:this.newVersionID=1,this.dialogVisible=!0},exportQualified:function(){var t=this;this.$http.post("/api/export/qualifiedexport",qs.stringify({product_id:this.$route.query.id,version_name:Number.isInteger(this.newVersionID)?"V"+this.newVersionID+".0":"V"+this.newVersionID})).then(function(e){e.data.require&&(window.open("","_self").location.href=e.data.require,t.$http.post("/api/product/details",qs.stringify({product_id:t.$route.query.id})).then(function(e){t.versionList=e.data.data,t.currentProject=e.data.data[0]}),t.dialogVisible=!1),e.data.error&&t.$message.warning("Export failed!"+e.data.error)})},exportHistoryVersion:function(t){var e=this;this.$confirm("Confirm to download "+t+"?","Download",{confirmButtonText:"Download",cancelButtonText:"Cancel",type:"warning",center:!0}).then(function(){e.$http.post("/api/export/oldversion",qs.stringify({product_id:e.$route.query.id,version_name:t})).then(function(t){t.data.require&&(window.open("","_self").location.href=t.data.require),t.data.error&&e.$message.warning("Export failed!"+t.data.error)})})},downloadFileFormat:function(){var t=this;this.$http.post("/api/translate/download").then(function(e){e.data.require?window.open("","_self").location.href=e.data.require:t.$message.warning("Export failed, please try again later.")})},openUploadModal:function(){this.dialogUploadVisible=!0,this.uploadProjectId=this.$route.query.id},closeResultModal:function(){this.resultVisible=!1,this.uploadResult={success_nums:[],error_row:[],row_key:[]}},closeUploadModal:function(){this.uploadProjectId=null,this.dialogUploadVisible=!1,$("#translateUpload").val(""),this.uploadFile={}},viewAllocationList:function(){this.$router.push({path:"/allocationlist",query:{id:this.$route.query.id}})},viewObjectionList:function(){this.$router.push({path:"/objectionlist",query:{id:this.$route.query.id}})},changeImportFile:function(t){this.uploadFile=t.target.files[0],this.uploadLoadingFlag=!0,this.submitUpload()},procductImport:function(){$("#translateUpload").trigger("click")},submitUpload:function(){var t=this,e=new FormData(document.getElementById("translateUpload"));e.append("translate_import",this.uploadFile),e.append("product_id",this.uploadProjectId),this.$http.post("/api/translate/import",e,{headers:{"Content-Type":"multipart/form-data"}}).then(function(e){t.uploadLoadingFlag=!1,t.resultVisible=!0,t.uploadResult=e.data.result})}}}}});
//# sourceMappingURL=9.js.map